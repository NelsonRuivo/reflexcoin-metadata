<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ReflexCoin 2.0 ‚Äî RFX2</title>

  <style>
    :root {
      --bg: #0D1B33;
      --panel: #111827;
      --panel-soft: #141B2F;
      --accent: #a855ff;
      --accent-soft: rgba(168, 85, 255, 0.15);
      --gold: #f4d47c;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f97373;
      --success: #22c55e;
      --radius: 14px;
    }

    html, body {
      margin: 0; padding: 0;
      background: radial-gradient(circle at top, #1e293b 0, var(--bg) 40%, #020617 100%);
      color: var(--text-main);
      font-family: system-ui, sans-serif;
    }

    .app {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* SIDEBAR (sem bot√µes repetidos) */
    .sidebar {
      width: 230px;
      background: #020617;
      border-right: 1px solid rgba(148, 163, 184, 0.24);
      padding: 22px 18px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .brand-mini img {
      width: 46px; height: 46px;
      border-radius: 999px;
      box-shadow: 0 0 14px rgba(244, 212, 124, 0.55);
    }

    .side-title {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 4px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .side-btn {
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(168, 85, 255, 0.05);
      font-size: 14px;
      color: var(--text-main);
      cursor: pointer;
    }

    .side-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .side-footer {
      margin-top: auto;
      font-size: 11px;
      color: var(--text-muted);
    }
  </style>
</head>

<body>
<div class="app">

  <!-- SIDEBAR SIMPLIFICADA -->
  <aside class="sidebar">
    <div class="brand-mini">
      <img src="logo-rfx2.png" alt="RFX2">
      <div>
        <div style="font-size:16px;font-weight:700;color:var(--gold);">ReflexCoin 2.0</div>
        <div style="font-size:12px;color:var(--text-muted);">RFX2 ‚Ä¢ Solana</div>
      </div>
    </div>

    <div>
      <div class="side-title">Wallet</div>
      <button id="btnConnectSide" class="side-btn">Connect Phantom</button>
      <button id="btnAddTokenSide" class="side-btn">Add RFX2 to Phantom</button>
    </div>

    <div>
      <div class="side-title">Trading</div>
      <button id="btnRaydiumSide" class="side-btn">Buy on Raydium</button>
    </div>

    <div>
      <div class="side-title">Community</div>
      <button id="btnTelegram" class="side-btn">Telegram</button>
      <button id="btnTwitter" class="side-btn">X / Twitter</button>
      <button id="btnGithub" class="side-btn">GitHub Repo</button>
    </div>

    <div class="side-footer">
      ReflexCoin 2.0 is an experimental emotional-value token.<br>
      Always verify the mint address.
    </div>
  </aside>

  <!-- MAIN AREA -->
  <main class="main" style="flex:1; padding:20px; overflow:hidden;">

    <!-- TOP HEADER -->
    <div style="display:flex;align-items:center;gap:20px;">
      <img src="logo-rfx2.png" style="width:80px;height:80px;border-radius:999px;box-shadow:0 0 30px rgba(244,212,124,0.5);">
      <div>
        <div style="font-size:28px;font-weight:800;color:var(--gold);">
          ReflexCoin 2.0 ‚Äî RFX2
        </div>
        <div style="color:var(--text-muted);font-size:13px;margin-top:4px;">
          Experimental emotional-value token on Solana.
        </div>
      </div>

      <div style="margin-left:auto;display:flex;gap:14px;">
        <div class="kpi">
          <div class="kpi-label">Total Supply</div>
          <div class="kpi-value">2,000,000</div>
          <div class="kpi-sub">Fixed ‚Ä¢ No inflation</div>
        </div>

        <div class="kpi">
          <div class="kpi-label">Price (USD)</div>
          <div class="kpi-value" id="priceUsd">N/A</div>
          <div class="kpi-sub" id="priceSol">N/A in SOL</div>
        </div>

        <div class="kpi">
          <div class="kpi-label">Market Cap</div>
          <div class="kpi-value" id="mcap">N/A</div>
          <div class="kpi-sub">Based on DEX</div>
        </div>
      </div>
    </div>

    <!-- ROW: CHART + VERIFY -->
    <div style="display:flex;gap:16px;margin-top:18px;height:44vh;">

      <!-- CHART LEFT -->
      <section class="card" style="flex:1;display:flex;flex-direction:column;">
        <div class="card-header">
          <div>
            <div class="card-title">Live Price & Chart</div>
            <div class="card-sub">Data from Dexscreener / Raydium</div>
          </div>
        </div>

        <!-- PRICE ROW -->
        <div style="display:flex;align-items:center;gap:20px;font-size:14px;margin:6px 0;">
          <div>
            <div class="price-item-label">Last price</div>
            <div id="lastPrice" class="price-item-value">N/A</div>
          </div>
          <div>
            <div class="price-item-label">24h change</div>
            <div id="change24" class="price-item-value">N/A</div>
          </div>

          <button id="btnOpenDex" class="btn-ghost" style="margin-left:auto;padding:6px 14px;">
            Open full chart ‚Üó
          </button>
        </div>

        <!-- IFRAME CORRIGIDO (SEM CORTES) -->
        <div style="flex:1;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.12);">
          <iframe
            id="dexFrame"
            src="https://dexscreener.com/solana/43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z?embed=1&theme=dark&trades=0&info=0"
            style="width:100%;height:100%;border:0;">
          </iframe>
        </div>
      </section>

      <!-- VERIFY RIGHT -->
      <section class="card" style="width:330px;">
        <div class="card-header">
          <div>
            <div class="card-title">Verify Authenticity</div>
            <div class="card-sub">Always confirm the official mint.</div>
          </div>
        </div>

        <div class="card-main">
          <a href="https://solscan.io/token/43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z" target="_blank" class="verify-link">View on Solscan</a>
          <a href="https://explorer.solana.com/address/43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z" target="_blank">Solana Explorer</a>
          <a href="https://raydium.io/swap/?inputMint=sol&outputMint=43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z" target="_blank">Swap on Raydium</a>
          <a href="https://github.com/ReflexCoin2-0-Project/reflexcoin-metadata" target="_blank">GitHub Metadata</a>

          <div style="margin-top:10px;font-size:11px;color:var(--text-muted);">
            Official Mint:<br>
            43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z
          </div>
        </div>

        <hr style="border:0;border-top:1px solid rgba(255,255,255,0.1);margin:12px 0;">

        <div>
          <div class="card-title">Wallet</div>
          <div class="card-sub" id="walletStatus">Not connected</div>

          <button id="btnConnectMain" class="btn btn-primary" style="width:100%;margin-top:10px;">
            Connect Phantom Wallet
          </button>

          <button id="btnAddTokenMain" class="btn btn-ghost" style="width:100%;margin-top:8px;">
            Add RFX2 to Phantom
          </button>

          <button id="btnRaydiumMain" class="btn btn-ghost" style="width:100%;margin-top:8px;">
            Buy / Sell on Raydium
          </button>

          <div style="font-size:11px;color:var(--text-muted);margin-top:8px;">
            Connected wallet: <span id="walletPk">‚Äî</span>
          </div>
        </div>
      </section>
    </div>

    <!-- EMOTION SECTION (SUBIDO + VIS√çVEL SEM SCROLL) -->
    <div style="margin-top:14px;display:flex;gap:16px;height:170px;">
      <section class="card" style="flex:1;">
        <div class="card-header">
          <div>
            <div class="card-title">Daily Emotion Log</div>
            <div class="card-sub">Used for future airdrop experiments</div>
          </div>
        </div>

        <div class="card-main">
          <div id="emotionButtons" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px;">
            <button class="emo-btn" data-emotion="happy">üòä Happy</button>
            <button class="emo-btn" data-emotion="angry">üò† Angry</button>
            <button class="emo-btn" data-emotion="sad">üò¢ Sad</button>
            <button class="emo-btn" data-emotion="motivated">üî• Motivated</button>
            <button class="emo-btn" data-emotion="loved">‚ù§Ô∏è Loved</button>
          </div>

          <button id="btnRecordEmotion" class="btn btn-primary" style="padding:6px 16px;">Record Emotion</button>
        </div>
      </section>
    </div> <!-- fecha emotion section -->

    <!-- FLOATING VIDEO (BOTTOM LEFT) -->
    <div id="videoBox"
      style="
        position:fixed;
        bottom:20px;
        left:20px;
        width:180px;
        height:110px;
        border-radius:12px;
        overflow:hidden;
        border:1px solid rgba(255,255,255,0.2);
        box-shadow:0 0 20px rgba(0,0,0,0.4);
        cursor:pointer;
        z-index:9999;
        background:#000;
      ">
      <video src="rfx2-video.mp4" autoplay muted loop style="width:100%;height:100%;object-fit:cover;"></video>
    </div>

    <!-- POPUP VIDEO -->
    <div id="videoPopup" 
      style="
        display:none;
        position:fixed;
        top:0;left:0;width:100%;height:100%;
        background:rgba(0,0,0,0.85);
        backdrop-filter:blur(6px);
        z-index:10000;
        justify-content:center;
        align-items:center;
      ">
      <video id="popupVid" src="rfx2-video.mp4" controls autoplay 
        style="width:80%;max-width:900px;border-radius:14px;"></video>
    </div>

    <!-- FOOTER -->
    <div style="margin-top:16px;font-size:11px;color:var(--text-muted);">
      ReflexCoin 2.0 ‚Äî ¬© 2025 ‚Ä¢ Contract: 43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z
    </div>

  </main>
</div>

<!-- SCRIPT FINAL -->
<script>
/* ------------------------------- */
/* CONSTANTES                      */
/* ------------------------------- */
const MINT = '43qV5jUhNEtsPeoLzEZyRLYA5tUSNTo2rgVv8mCJsx9z';
const DEX_API = 'https://api.dexscreener.com/latest/dex/tokens/' + MINT;
const RAY_LINK = 'https://raydium.io/swap/?inputMint=sol&outputMint=' + MINT;
const LOGO_URL = 'https://raw.githubusercontent.com/ReflexCoin2-0-Project/reflexcoin-metadata/main/logo-rfx2.png';

/* ------------------------------- */
/* VIDEO POPUP                     */
/* ------------------------------- */
document.getElementById("videoBox").onclick = () => {
  document.getElementById("videoPopup").style.display = "flex";
};

document.getElementById("videoPopup").onclick = (e) => {
  if (e.target.id === "videoPopup") {
    document.getElementById("videoPopup").style.display = "none";
    document.getElementById("popupVid").pause();
  }
};

/* ------------------------------- */
/* SHORT WALLET FORMAT             */
/* ------------------------------- */
function shortPk(pk) {
  return pk ? pk.slice(0, 4) + "..." + pk.slice(-4) : "‚Äî";
}

/* ------------------------------- */
/* PHANTOM CONNECTION              */
/* ------------------------------- */
async function connectPhantom() {
  if (!window.solana || !window.solana.isPhantom) {
    alert("Please install Phantom Wallet extension.");
    return;
  }
  try {
    const resp = await window.solana.connect();
    const pk = resp.publicKey.toString();
    document.getElementById("walletStatus").textContent = "Connected";
    document.getElementById("walletPk").textContent = shortPk(pk);
    localStorage.setItem("rfx2_pk", pk);
  } catch (err) {
    console.error(err);
    alert("Connection rejected.");
  }
}

/* ------------------------------- */
/* BUTTON WIRING                   */
/* ------------------------------- */
function wireButtons() {
  document.getElementById("btnConnectMain").onclick = connectPhantom;
  document.getElementById("btnConnectSide").onclick = connectPhantom;

  document.getElementById("btnRaydiumMain").onclick =
  document.getElementById("btnRaydiumSide").onclick =
    () => window.open(RAY_LINK, "_blank");

  document.getElementById("btnAddTokenMain").onclick =
  document.getElementById("btnAddTokenSide").onclick =
    async () => {
      if (window.solana && window.solana.request) {
        try {
          await window.solana.request({
            method: "wallet_watchAsset",
            params: {
              type: "spl-token",
              options: {
                address: MINT,
                symbol: "RFX2",
                decimals: 9,
                image: LOGO_URL
              }
            }
          });
        } catch (e) {
          window.open("https://phantom.app/ul/browse/" + MINT);
        }
      }
    };

  document.getElementById("btnTelegram").onclick =
    () => window.open("https://t.me/ReflexCoinCommunity", "_blank");

  document.getElementById("btnTwitter").onclick =
    () => window.open("https://x.com/ReflexcoinRfx", "_blank");

  document.getElementById("btnGithub").onclick =
    () => window.open("https://github.com/ReflexCoin2-0-Project/reflexcoin-metadata", "_blank");

  document.getElementById("btnOpenDex").onclick =
    () => window.open("https://dexscreener.com/solana/" + MINT, "_blank");
}

/* ------------------------------- */
/* LOAD PRICE DATA                 */
/* ------------------------------- */
async function loadDexData() {
  try {
    const res = await fetch(DEX_API);
    const data = await res.json();
    if (!data.pairs || !data.pairs.length) return;

    const p = data.pairs[0];
    const priceUsd = Number(p.priceUsd);
    const priceSol = Number(p.priceNative);
    const fdv = Number(p.fdv);
    const change = Number(p.priceChange?.h24);

    document.getElementById("priceUsd").textContent =
      priceUsd ? "$" + priceUsd.toFixed(6) : "N/A";

    document.getElementById("priceSol").textContent =
      priceSol ? priceSol.toFixed(8) + " SOL" : "N/A in SOL";

    document.getElementById("lastPrice").textContent =
      priceUsd ? "$" + priceUsd.toFixed(6) : "N/A";

    document.getElementById("mcap").textContent =
      fdv ? "$" + fdv.toLocaleString() : "N/A";

    const ch = document.getElementById("change24");
    if (change || change === 0) {
      ch.textContent = (change > 0 ? "+" : "") + change.toFixed(2) + "%";
      ch.style.color = change >= 0 ? "#22c55e" : "#f97373";
    }

  } catch (err) {
    console.warn("DEX data not ready:", err);
  }
}

/* ------------------------------- */
/* EMOTION LOGGER                  */
/* ------------------------------- */
const EMO_KEY = "rfx2_emotions";
let selectedEmotion = null;

document.getElementById("emotionButtons").onclick = e => {
  const btn = e.target.closest("button");
  if (!btn) return;

  document.querySelectorAll(".emo-btn").forEach(b => b.style.opacity = 0.4);
  btn.style.opacity = 1;
  selectedEmotion = btn.dataset.emotion;
};

document.getElementById("btnRecordEmotion").onclick = () => {
  if (!selectedEmotion) { alert("Choose an emotion first."); return; }

  const data = JSON.parse(localStorage.getItem(EMO_KEY) || "{}");
  const today = new Date().toISOString().slice(0, 10);
  const pk = localStorage.getItem("rfx2_pk") || "anon";
  data[today + "_" + pk] = selectedEmotion;

  localStorage.setItem(EMO_KEY, JSON.stringify(data));

  alert("Emotion saved (local only).");
};

/* ------------------------------- */
/* INIT                            */
/* ------------------------------- */
(function init(){
  wireButtons();
  loadDexData();

  const pk = localStorage.getItem("rfx2_pk");
  if (pk) {
    document.getElementById("walletStatus").textContent = "Connected (cached)";
    document.getElementById("walletPk").textContent = shortPk(pk);
  }
})();
</script>

</body>
</html>
